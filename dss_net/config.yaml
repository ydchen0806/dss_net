# ====================================================================
# å®éªŒé…ç½®
# ====================================================================
experiment:
  name: "ChannelDecomposition"
  seed: 42
  output_dir: "./experiments1017"
  
# ====================================================================
# æ•°æ®é…ç½®
# ====================================================================
data:
  data_dir: "/LSEM/user/chenyinda/code/signal_xiaoyu"
  pattern: "2D_channel_for_DSS/Tx_all_2D_*.mat"
  max_files: null # nullè¡¨ç¤ºåŠ è½½æ‰€æœ‰æ–‡ä»¶
  
  # æ•°æ®é›†åˆ’åˆ†
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  
  # æ•°æ®é¢„å¤„ç†
  normalize_method: "power"  # standard, power, minmax
  complex_representation: "real_imag"  # real_imag, mag_phase
  
  # DataLoaderé…ç½®
  num_workers: 4
  pin_memory: true
  
  # æ•°æ®å¢å¼ºï¼ˆè®­ç»ƒæ—¶ï¼‰
  augmentation:
    enabled: true
    spatial_masking:
      prob: 0.3
      mask_ratio: 0.1
    noise_injection:
      prob: 0.3
      snr_range: [20, 35]

# ====================================================================
# æ¨¡å‹é…ç½®ï¼ˆæ”¹è¿›ç‰ˆï¼‰
# ====================================================================
model:
  # æ¨¡å‹é€‰æ‹©
  name: "UNetDecomposer"
  
  # U-Netæ¶æ„
  in_channels: 2
  base_channels: 64          # å¯ä»¥å°è¯•å¢åŠ åˆ°128
  depth: 4
  
  # è¾“å‡ºå¤´
  output_heads:
    static: 2
    dynamic: 2
  
  # æ¿€æ´»å‡½æ•°
  activation: "leaky_relu"
  norm_type: "batch"
  
  # Dropout
  dropout: 0.1               # ğŸ”§ é™ä½dropoutï¼ˆä»0.15â†’0.1ï¼‰
  
  # ğŸ†• æ³¨æ„åŠ›æœºåˆ¶
  use_attention: true        # å¯ç”¨bottleneck attention
  
  # æ¶ˆèå®éªŒé…ç½®
  ablation:
    enabled: false

# ====================================================================
# æŸå¤±å‡½æ•°é…ç½®ï¼ˆæ”¹è¿›ç‰ˆï¼‰
# ====================================================================
loss:
  # ğŸ”§ æ”¹è¿›çš„æŸå¤±æƒé‡ï¼ˆæ›´æ³¨é‡é‡å»ºè´¨é‡ï¼‰
  weights:
    static_mse: 1.0          # é™æ€é‡å»º
    dynamic_mse: 2.0         # ğŸ”§ åŠ¨æ€é‡å»ºæƒé‡åŠ å¤§ï¼ˆä»1.0â†’2.0ï¼‰
    total_mse: 3.0           # ğŸ”§ æ€»é‡å»ºæœ€é‡è¦ï¼ˆä»2.0â†’3.0ï¼‰
    static_l1: 0.01          # ğŸ”§ å¤§å¹…å‡å¼±ç¨€ç–æ€§çº¦æŸï¼ˆä»0.1â†’0.01ï¼‰
    dynamic_nuclear: 0.01    # ğŸ”§ å¤§å¹…å‡å¼±ä½ç§©çº¦æŸï¼ˆä»0.1â†’0.01ï¼‰
    static_temporal: 0.01    # ğŸ”§ å‡å¼±æ—¶é—´å¹³æ»‘çº¦æŸï¼ˆä»0.05â†’0.01ï¼‰
    dynamic_temporal: 0.01   # ğŸ”§ å‡å¼±æ—¶é—´å˜åŒ–çº¦æŸï¼ˆä»0.05â†’0.01ï¼‰
  
  # ğŸ”§ å¤§å¹…å‡å¼±æ­£åˆ™åŒ–å¼ºåº¦
  sparsity_lambda: 0.0001    # ğŸ”§ ä»0.001é™åˆ°0.0001
  nuclear_lambda: 0.0001     # ğŸ”§ ä»0.001é™åˆ°0.0001
  
  # ğŸ†• åˆ†ç¦»è´¨é‡æƒé‡
  separation_weight: 0.05    # é¼“åŠ±é™æ€å’ŒåŠ¨æ€åˆ†é‡ä¸åŒ
  
  # æ—¶é—´ç›¸å…³æ€§çº¦æŸ
  temporal_correlation:
    enabled: true
    static_smooth: true
    dynamic_varying: true
    dim: -1

# ====================================================================
# è®­ç»ƒé…ç½®ï¼ˆæ”¹è¿›ç‰ˆï¼‰
# ====================================================================
training:
  # ä¼˜åŒ–å™¨
  optimizer: "adamw"
  learning_rate: 1.0e-3       # ğŸ”§ å­¦ä¹ ç‡åŠ å¤§ï¼ˆä»5e-4â†’1e-3ï¼‰
  weight_decay: 1.0e-4
  
  # å­¦ä¹ ç‡è°ƒåº¦
  scheduler:
    type: "cosine"
    warmup_epochs: 5          # ğŸ”§ å‡å°‘warmupï¼ˆä»10â†’5ï¼‰
    min_lr: 1.0e-6            # ğŸ”§ æ›´ä½çš„æœ€å°å­¦ä¹ ç‡ï¼ˆä»5e-7â†’1e-6ï¼‰
  
  # è®­ç»ƒå‚æ•°
  epochs: 300                 # ğŸ”§ å¢åŠ è®­ç»ƒæ—¶é—´ï¼ˆä»100â†’150ï¼‰
  batch_size: 192
  gradient_clip: 1.0
  
  # æ—©åœ
  early_stopping:
    patience: 30              # ğŸ”§ å¢åŠ è€å¿ƒï¼ˆä»20â†’30ï¼‰
    min_delta: 0.0001         # ğŸ”§ æ›´ä¸¥æ ¼çš„åˆ¤æ–­æ ‡å‡†ï¼ˆä»0.0005â†’0.0001ï¼‰

# ====================================================================
# éªŒè¯å’Œæ—¥å¿—
# ====================================================================
validation:
  interval: 1  # æ¯Nä¸ªepochéªŒè¯ä¸€æ¬¡
  save_best_only: true
  
logging:
  log_interval: 10  # æ¯Nä¸ªbatchæ‰“å°ä¸€æ¬¡
  tensorboard: true
  save_checkpoint_interval: 10
  
  # ğŸ¨ å¯è§†åŒ–é…ç½®ï¼ˆé›†æˆTensorBoardå¯è§†åŒ–ï¼‰
  visualization:
    enabled: true              # æ˜¯å¦å¯ç”¨å¯è§†åŒ–
    interval: 5                # æ¯Nä¸ªepochè®°å½•ä¸€æ¬¡å¯è§†åŒ–å›¾åƒ
    num_samples: 4             # æ¯æ¬¡å¯è§†åŒ–å±•ç¤ºçš„æ ·æœ¬æ•°é‡
    modes: ['magnitude', 'phase']  # å¯è§†åŒ–æ¨¡å¼ï¼šmagnitudeï¼ˆå¹…åº¦ï¼‰å’Œ/æˆ– phaseï¼ˆç›¸ä½ï¼‰
  
  # ğŸ†• å¯è§†åŒ–é…ç½®
  visualization:
    enabled: true              # æ˜¯å¦å¯ç”¨å¯è§†åŒ–
    interval: 5                # æ¯Nä¸ªepochè®°å½•ä¸€æ¬¡å¯è§†åŒ–å›¾åƒ
    num_samples: 4             # æ¯æ¬¡å¯è§†åŒ–å±•ç¤ºçš„æ ·æœ¬æ•°é‡
    modes: ['magnitude', 'phase']  # å¯è§†åŒ–æ¨¡å¼ï¼šmagnitudeï¼ˆå¹…åº¦ï¼‰å’Œ/æˆ– phaseï¼ˆç›¸ä½ï¼‰

# ====================================================================
# ç¡¬ä»¶é…ç½®
# ====================================================================
hardware:
  device: "cuda"
  use_amp: true      # æ··åˆç²¾åº¦è®­ç»ƒ
  use_ddp: true      # âœ… å¯ç”¨DDPå¤šGPUè®­ç»ƒ